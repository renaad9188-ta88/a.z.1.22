# خطوات إصلاح صفحة الإدارة

## الوضع الحالي:
- ✅ المستخدم `tamer88@gmail.com` موجود في `auth.users`
- ✅ المستخدم لديه `role = 'admin'` في `profiles`
- ✅ السياسات الإدارية موجودة
- ❌ لكن لا تزال هناك مشكلة في جلب البيانات (خطأ 500)

## الحلول:

### الحل 1: اختبار الوصول مباشرة

1. سجل الدخول كإداري (`tamer88@gmail.com`)
2. اذهب إلى Supabase Dashboard > SQL Editor
3. نفذ ملف `supabase/DEBUG_ADMIN_ACCESS.sql`
4. تحقق من النتائج:
   - إذا نجح `SELECT COUNT(*) FROM visit_requests` → السياسات تعمل
   - إذا فشل → المشكلة في السياسات

### الحل 2: إعادة تطبيق السياسات

إذا فشل الاختبار، نفذ:
1. `supabase/ENSURE_ADMIN_POLICIES.sql` - لإعادة إنشاء السياسات
2. `supabase/FIX_ADMIN_tamer88_gmail.sql` - للتأكد من profile

### الحل 3: التحقق من Console

1. افتح المتصفح (F12)
2. اذهب إلى Console
3. انظر إلى رسائل الخطأ الدقيقة
4. شاركها معي

### الحل 4: تحديث الصفحة

بعد تنفيذ الملفات:
1. امسح Cache المتصفح (Ctrl+Shift+Delete)
2. أو استخدم Incognito Mode
3. سجل الدخول مرة أخرى
4. اذهب إلى `/admin`

## الملفات المهمة:

- `DEBUG_ADMIN_ACCESS.sql` - اختبار الوصول
- `ENSURE_ADMIN_POLICIES.sql` - إعادة إنشاء السياسات
- `FIX_ADMIN_tamer88_gmail.sql` - إصلاح profile

## بعد الإصلاح:

ستجد في صفحة الإدارة:
- ✅ جميع الطلبات
- ✅ الإحصائيات
- ✅ البحث والتصفية
- ✅ عرض التفاصيل الكاملة
- ✅ الصور (الجوازات والدفعات)
- ✅ الرد على المستخدمين





